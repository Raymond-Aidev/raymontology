# =============================================================================
# Raymontology - Railway Environment Variables
# =============================================================================
#
# 이 파일은 Railway 배포를 위한 환경 변수 템플릿입니다.
# Railway Dashboard의 "Variables" 탭에서 아래 변수들을 설정하세요.
#
# 주의사항:
# - 이 파일을 Git에 커밋하지 마세요 (.gitignore에 포함)
# - 실제 값은 Railway Dashboard에서 직접 설정하세요
# - ${{Service.VARIABLE}} 문법으로 Railway 서비스 간 변수 참조 가능
# =============================================================================

# =============================================================================
# 1. DATABASE CONFIGURATION
# =============================================================================

# PostgreSQL (Railway에서 자동 생성)
# Railway: New → Database → Add PostgreSQL
DATABASE_URL=${{Postgres.DATABASE_URL}}
# 형식: postgresql://user:password@host:port/database
# 예시: postgresql://postgres:password@containers-us-west-123.railway.app:5432/railway

# PostgreSQL Connection Pool Settings (Railway 최적화)
SQLALCHEMY_POOL_SIZE=10
SQLALCHEMY_MAX_OVERFLOW=20
SQLALCHEMY_POOL_TIMEOUT=30
SQLALCHEMY_POOL_RECYCLE=1800

# Redis (Railway에서 자동 생성)
# Railway: New → Database → Add Redis
REDIS_URL=${{Redis.REDIS_URL}}
# 형식: redis://default:password@host:port
# 예시: redis://default:password@containers-us-west-456.railway.app:6379

# Redis Connection Settings
REDIS_MAX_CONNECTIONS=50
REDIS_SOCKET_TIMEOUT=5
REDIS_SOCKET_CONNECT_TIMEOUT=5

# Neo4j (외부 서비스 사용 - Railway는 Neo4j 미지원)
# Neo4j Aura (https://neo4j.com/cloud/aura/) 또는 다른 호스팅 서비스 사용
NEO4J_URI=neo4j+s://xxxxx.databases.neo4j.io
# 예시: neo4j+s://12345678.databases.neo4j.io

NEO4J_USER=neo4j
# 기본값: neo4j

NEO4J_PASSWORD=your_strong_neo4j_password_here
# Neo4j 콘솔에서 생성된 비밀번호 입력

NEO4J_DATABASE=neo4j
# 기본 데이터베이스 이름 (Free tier는 'neo4j' 고정)

# =============================================================================
# 2. SECURITY & AUTHENTICATION
# =============================================================================

# JWT Secret Key (필수 - 강력한 랜덤 문자열 사용)
# 생성 방법: python -c "import secrets; print(secrets.token_urlsafe(32))"
SECRET_KEY=your_super_secret_key_here_minimum_32_characters_long
# 예시: xJ9vK2mP4nQ7rS8tU1vW3xY5zA6bC8dE9fG0hI2jK4lM6nO8pQ0rS2tU4vW6xY8z

# JWT Algorithm
ALGORITHM=HS256
# 기본값: HS256 (HMAC with SHA-256)

# Access Token Expiration (분 단위)
ACCESS_TOKEN_EXPIRE_MINUTES=30
# 기본값: 30분

# Refresh Token Expiration (일 단위)
REFRESH_TOKEN_EXPIRE_DAYS=7
# 기본값: 7일

# Password Hashing Rounds (bcrypt cost factor)
BCRYPT_ROUNDS=12
# 기본값: 12 (높을수록 안전하지만 느림)

# =============================================================================
# 3. APPLICATION SETTINGS
# =============================================================================

# Environment (production/staging/development)
ENVIRONMENT=production
# Railway 배포시 반드시 'production' 사용

# Debug Mode (Boolean)
DEBUG=false
# 프로덕션에서는 반드시 false로 설정

# Application Name
APP_NAME=Raymontology
# 로그 및 모니터링에서 사용

# API Version
API_VERSION=v1
# API 엔드포인트 버전 (/api/v1/...)

# Frontend URL (CORS 설정에 사용)
FRONTEND_URL=https://raymontology-frontend.up.railway.app
# Railway에서 생성된 Frontend 도메인으로 변경
# 커스텀 도메인 사용시: https://yourdomain.com

# Backend URL (Frontend에서 API 호출시 사용)
BACKEND_URL=https://raymontology-backend.up.railway.app
# Railway에서 생성된 Backend 도메인으로 변경

# =============================================================================
# 4. CORS CONFIGURATION
# =============================================================================

# Allowed Origins (쉼표로 구분)
ALLOWED_ORIGINS=https://raymontology-frontend.up.railway.app,https://yourdomain.com
# 여러 도메인 허용시 쉼표로 구분
# 로컬 개발시: http://localhost:5173,http://127.0.0.1:5173

# Allowed Methods
ALLOWED_METHODS=GET,POST,PUT,DELETE,PATCH,OPTIONS
# 기본값: 모든 주요 HTTP 메소드

# Allowed Headers
ALLOWED_HEADERS=*
# 기본값: 모든 헤더 허용

# Allow Credentials
ALLOW_CREDENTIALS=true
# 쿠키/인증 헤더 허용 여부

# =============================================================================
# 5. DART API CONFIGURATION
# =============================================================================

# DART API Key (필수)
# 발급: https://opendart.fss.or.kr/
# 계정 생성 → 인증키 신청 → 이메일로 발급
DART_API_KEY=your_dart_api_key_here
# 예시: 1234567890abcdef1234567890abcdef12345678

# DART API Rate Limit (requests per second)
DART_RATE_LIMIT=10
# 기본값: 10 (DART API 공식 제한)

# DART Request Timeout (seconds)
DART_TIMEOUT=30
# 기본값: 30초

# DART Retry Attempts
DART_RETRY_ATTEMPTS=3
# 실패시 재시도 횟수

# DART Retry Delay (seconds)
DART_RETRY_DELAY=5
# 재시도 간 대기 시간

# =============================================================================
# 6. CELERY CONFIGURATION
# =============================================================================

# Celery Broker URL (Redis 사용)
CELERY_BROKER_URL=${{Redis.REDIS_URL}}
# Redis URL과 동일

# Celery Result Backend
CELERY_RESULT_BACKEND=${{Redis.REDIS_URL}}
# Redis URL과 동일

# Celery Task Time Limit (seconds)
CELERY_TASK_TIME_LIMIT=3600
# 기본값: 1시간 (크롤링/파싱 작업용)

# Celery Soft Time Limit (seconds)
CELERY_SOFT_TIME_LIMIT=3300
# 기본값: 55분 (hard limit 전 경고)

# Celery Worker Concurrency
CELERY_WORKER_CONCURRENCY=4
# Railway 리소스에 따라 조정 (2-8 권장)

# Celery Task Serializer
CELERY_TASK_SERIALIZER=json
# 기본값: json

# Celery Result Serializer
CELERY_RESULT_SERIALIZER=json
# 기본값: json

# =============================================================================
# 7. STORAGE CONFIGURATION
# =============================================================================

# Storage Type (local/s3/r2)
STORAGE_TYPE=local
# local: Railway volume 사용
# s3: AWS S3
# r2: Cloudflare R2 (S3 호환)

# Local Storage Path (Railway volume mount point)
STORAGE_PATH=/app/data
# Railway volume mount: /app/data

# AWS S3 / Cloudflare R2 (선택사항)
# S3_BUCKET_NAME=raymontology-disclosures
# S3_REGION=us-west-2
# S3_ACCESS_KEY_ID=your_access_key
# S3_SECRET_ACCESS_KEY=your_secret_key
# S3_ENDPOINT_URL=https://your-account-id.r2.cloudflarestorage.com

# =============================================================================
# 8. LOGGING CONFIGURATION
# =============================================================================

# Log Level (DEBUG/INFO/WARNING/ERROR/CRITICAL)
LOG_LEVEL=INFO
# 프로덕션: INFO 또는 WARNING

# Log Format
LOG_FORMAT=json
# json: 구조화된 로그 (Railway 권장)
# text: 일반 텍스트

# Log to File (Boolean)
LOG_TO_FILE=false
# Railway는 stdout 로그 수집 사용 (false 권장)

# Log File Path (LOG_TO_FILE=true일 때만 사용)
# LOG_FILE_PATH=/app/logs/app.log

# =============================================================================
# 9. MONITORING & OBSERVABILITY
# =============================================================================

# Sentry DSN (선택사항 - 에러 추적)
# 발급: https://sentry.io/
# SENTRY_DSN=https://examplePublicKey@o0.ingest.sentry.io/0
# SENTRY_ENVIRONMENT=production
# SENTRY_TRACES_SAMPLE_RATE=0.1

# OpenTelemetry (선택사항)
# OTEL_ENABLED=false
# OTEL_ENDPOINT=https://api.honeycomb.io
# OTEL_API_KEY=your_honeycomb_api_key

# Prometheus Metrics (선택사항)
# PROMETHEUS_ENABLED=false
# PROMETHEUS_PORT=9090

# =============================================================================
# 10. RATE LIMITING
# =============================================================================

# API Rate Limit (requests per minute per IP)
API_RATE_LIMIT=100
# 기본값: 100 req/min

# API Rate Limit Window (seconds)
API_RATE_LIMIT_WINDOW=60
# 기본값: 60초 (1분)

# Rate Limit Strategy (fixed/sliding)
RATE_LIMIT_STRATEGY=sliding
# sliding: 더 정확한 제한
# fixed: 더 빠른 성능

# =============================================================================
# 11. FEATURE FLAGS
# =============================================================================

# Enable NLP Parser
ENABLE_NLP_PARSER=true
# NLP 파싱 기능 활성화 여부

# Enable Risk Engine
ENABLE_RISK_ENGINE=true
# 리스크 분석 엔진 활성화 여부

# Enable DART Crawler
ENABLE_DART_CRAWLER=true
# DART 크롤러 활성화 여부

# Enable Neo4j Graph
ENABLE_NEO4J_GRAPH=true
# Neo4j 그래프 기능 활성화 여부

# Enable Email Notifications
ENABLE_EMAIL_NOTIFICATIONS=false
# 이메일 알림 기능 (미구현)

# =============================================================================
# 12. EMAIL CONFIGURATION (선택사항)
# =============================================================================

# SMTP Settings (필요시 구현)
# SMTP_HOST=smtp.gmail.com
# SMTP_PORT=587
# SMTP_USER=noreply@yourdomain.com
# SMTP_PASSWORD=your_smtp_password
# SMTP_FROM_EMAIL=noreply@yourdomain.com
# SMTP_FROM_NAME=Raymontology

# =============================================================================
# 13. FRONTEND ENVIRONMENT VARIABLES
# =============================================================================
# Frontend 서비스의 Variables 탭에 별도로 설정

# VITE_API_URL=https://raymontology-backend.up.railway.app
# Backend API 엔드포인트 URL

# VITE_APP_NAME=Raymontology
# 애플리케이션 이름

# VITE_ENVIRONMENT=production
# 환경 구분

# =============================================================================
# 14. RAILWAY-SPECIFIC SETTINGS
# =============================================================================

# Port (Railway가 자동 설정)
PORT=${{PORT}}
# Railway가 자동으로 할당하는 포트 번호

# Railway Environment
RAILWAY_ENVIRONMENT=${{RAILWAY_ENVIRONMENT}}
# Railway 환경 정보 (자동 설정)

# Railway Service Name
RAILWAY_SERVICE_NAME=${{RAILWAY_SERVICE_NAME}}
# Railway 서비스 이름 (자동 설정)

# =============================================================================
# 설정 방법
# =============================================================================
#
# 1. Railway Dashboard 접속
#    - https://railway.app → 프로젝트 선택
#
# 2. Backend 서비스 선택
#    - Variables 탭 클릭
#
# 3. 환경 변수 추가
#    - "New Variable" 클릭
#    - 변수명과 값 입력
#    - Save 클릭
#
# 4. Railway 변수 참조 (서비스 간)
#    - DATABASE_URL=${{Postgres.DATABASE_URL}}
#    - REDIS_URL=${{Redis.REDIS_URL}}
#
# 5. 변경사항 적용
#    - 환경 변수 추가/수정 후 자동 재배포
#    - 또는 "Redeploy" 버튼 클릭
#
# =============================================================================
# 보안 주의사항
# =============================================================================
#
# 1. 절대 Git에 커밋하지 마세요
#    - .gitignore에 .env* 추가 확인
#
# 2. 강력한 비밀번호 사용
#    - SECRET_KEY: 최소 32자
#    - 데이터베이스 비밀번호: 복잡한 조합
#
# 3. 프로덕션 전용 키 사용
#    - 개발/테스트 키 재사용 금지
#
# 4. 정기적인 키 교체
#    - SECRET_KEY: 6개월마다
#    - API 키: 1년마다
#
# 5. 최소 권한 원칙
#    - 필요한 권한만 부여
#    - 서비스 계정 분리
#
# =============================================================================
# 배포 후 확인사항
# =============================================================================
#
# 1. Health Check
#    curl https://raymontology-backend.up.railway.app/health
#
# 2. 환경 변수 확인
#    - Railway Dashboard → Backend → Variables
#    - 모든 필수 변수 설정 확인
#
# 3. 로그 확인
#    - Railway Dashboard → Backend → Logs
#    - 시작 에러 없는지 확인
#
# 4. 데이터베이스 연결 확인
#    - PostgreSQL: Railway Dashboard → Postgres → Query
#    - Redis: Railway Dashboard → Redis → Data
#    - Neo4j: Neo4j Browser로 연결 테스트
#
# 5. API 테스트
#    - 로그인: POST /api/auth/login
#    - 검색: GET /api/companies/search?query=삼성
#
# =============================================================================
